$(document).ready(function(){function t(){var t={zoom:13,center:new google.maps.LatLng(42.139541,-87.928747)};var n=new google.maps.Map(document.getElementById("map"),t);var r=new google.maps.InfoWindow({maxWidth:Math.round($("#map").width()*.65)});$('#map_objects > div[data-visible="true"]').each(function(){var t=$(this).attr("id");var i=$(this).data("type");var s=this.outerHTML;var o;var u;if($(this).data("custom_lat")&&$(this).data("custom_lng")){o=new google.maps.LatLng($(this).data("custom_lat"),$(this).data("custom_lng"))}else{o=new google.maps.LatLng($(this).data("BC_lat"),$(this).data("BC_lng"))}if(i=="Pool"){u="http://maps.google.com/mapfiles/ms/micons/blue.png"}else if(i=="Country Club"){u="http://maps.google.com/mapfiles/ms/micons/lightblue.png"}else if(i=="Golf Course"){u="http://maps.google.com/mapfiles/ms/micons/orange.png"}else if(i=="Park"){u="http://maps.google.com/mapfiles/ms/micons/green.png"}else if(i=="Recreation Center"){u="http://maps.google.com/mapfiles/ms/micons/red.png"}else{u="http://maps.google.com/mapfiles/ms/micons/red.png"}var a=new google.maps.Marker({map:n,position:o,title:$(this).data("name"),icon:u});google.maps.event.addListener(a,"click",function(){r.close();r.setContent(s);r.open(n,a)});if($(this).data("active")=="true"){e=a}})}function n(){function n(){$("#typeToggles label input:checked").each(function(){var e=$(this).parent().attr("id").slice($(this).parent().attr("id").indexOf("_")+1).replace(/-/," ");$("#map_objects").children('div[data-type="'+e+'"]').attr("data-visible","true")})}function r(){$("#featureToggles label input:checked").each(function(){$("#map_objects").children('div[data-features*="'+$(this).val()+'"]').attr("data-visible","true")})}var e=$("#typeToggles label input:checked").length>=1;var t=$("#featureToggles label input:checked").length>=1;if(e||t){$("#map_objects").children("div").attr("data-visible","false")}else{$("#map_objects").children("div").attr("data-visible","true")}if(t&&!e){r()}if(!t&&e){n()}if(t&&e){n();var i=$("#map_objects").children('div[data-visible="true"]');i.each(function(){$(this).attr("data-visible","false")});$("#featureToggles label input:checked").each(function(){i.filter($('div[data-features*="'+$(this).val()+'"]')).attr("data-visible","true")})}}var e;$("#typeToggles label input").change(function(){n();$("body").trigger("mapRefresh")});$("#featureToggles label input").change(function(){n();$("body").trigger("mapRefresh")});$("body").on("mapRefresh",function(n){t();if(e){google.maps.event.trigger(e,"click")}});t()})